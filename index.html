<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>신호등 남은시간</title>
</head>

<body>
    <div id="map" style="width: 1000px; height: 1600px;"></div>
    <button type="button" onclick="location.reload(true);">새로고침</button>

    <script type="text/javascript"
        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=7ef40657408ed36391ff4a883ea362d8"></script>
    <script type="text/javascript">

        var container = document.getElementById('map'); //지도를 담을 영역의 DOM 레퍼런스
        var options = { //지도를 생성할 때 필요한 기본 옵션
            center: new kakao.maps.LatLng(37.194760, 127.074814), //지도의 중심좌표.
            level: 1 //지도의 레벨(확대, 축소 정도)
        };

        var map = new kakao.maps.Map(container, options); //지도 생성 및 객체 리턴


        var positions = [
            {
                title: '신호등 1번',
                latlng: new kakao.maps.LatLng(37.194630, 127.075030)
            },
            {
                title: '신호등 2번',
                latlng: new kakao.maps.LatLng(37.194910, 127.074654)
            },
            {
                title: '신호등 3번',
                latlng: new kakao.maps.LatLng(37.194640, 127.074644) 
            },
            {
                title: '신호등 4번',
                latlng: new kakao.maps.LatLng(37.194910, 127.074964)
            }
        ];
        map.setZoomable(false);
        
        for (var i = 0; i < positions.length; i++) {

            var marker = new kakao.maps.Marker({  // 마커 생성
                map: map, // 마커를 표시할 지도
                position: positions[i].latlng, // 마커를 표시할 위치
                title: positions[i].title, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시 됨
            });
        }
        
        function clock(){
        var d= new Date();
        var total=d.getHours()*3600+d.getMinutes()*60+d.getSeconds()
        
        var remain = 155;
        var a1_2 = 47;
        var a2_3 = 49;
        var a3_4 = 40;
        var a4_1 = 38;
         
        var iwPositioncontent [
                {  
                    position: new kakao.maps.LatLng(37.194730, 127.075200), //인포윈도우 표시 위치입니다
                    content: '<font size = 5><div style="width:200px; height:40px;">1번 남은시간: </div></font>'+(225-(total-remain)%250)
                    
                },
                {  
                    position: new kakao.maps.LatLng(37.194730, 127.075200), //인포윈도우 표시 위치입니다
                    content: '<font size = 5><div style="background-color:red; width:200px; height:40px;">1번 바뀌었습니다.</font></div>'+(25-(total-remain)%250)
                    
                },
                {
                    position: new kakao.maps.LatLng(37.195010, 127.074604),
                    content: '<font size = 5><div style=" width:200px; height:40px;">2번 남은시간</font></div>'+((total-remain)%250)
                },
                {
                    position: new kakao.maps.LatLng(37.195010, 127.074604),
                    content: '<font size = 5><div style="background-color:red; width:200px; height:40px;">2번 바뀌었습니다. </font></div>'+((total-remain)%250)
                },
                {
                    position: new kakao.maps.LatLng(37.194740, 127.074544),
                    content: '<font size = 5><div style=" width:200px; height:40px;">3번 남은시간</font></div>'+((total-remain)%250)
                },
                {
                    position: new kakao.maps.LatLng(37.194740, 127.074544),
                    content: '<font size = 5><div style="background-color:red; width:200px; height:40px;">3번 바뀌었습니다. </font></div>'+((total-remain)%250)
                },
                
                {
                    position: new kakao.maps.LatLng(37.195010, 127.075264),
                    content: '<font size = 5><div style=" width:200px; height:40px;">4번 남은시간</font></div>'+((total-remain)%250)
                },
                {
                    position: new kakao.maps.LatLng(37.195010, 127.075264),
                    content: '<font size = 5><div style="background-color:red; width:200px; height:40px;">4번 바뀌었습니다. </font></div>'+((total-remain)%250)
                }
        ]; 
        

        // 인포윈도우를 생성합니다
        var i=0;
        if((total-15)%250<40){i=1;}
        var infowindow = new kakao.maps.InfoWindow({
                position: iwPositioncontent[i].position,
                content: iwPositioncontent[i].content
                
            });
        infowindow.open(map);
        var i=2;
        if((total-15)%250<40){i=3;}
        var infowindow = new kakao.maps.InfoWindow({
                position: iwPositioncontent[i].position,
                content: iwPositioncontent[i].content
                
            });
        infowindow.open(map);
        var i=4;
        if((total-15)%250<40){i=5;}
        var infowindow = new kakao.maps.InfoWindow({
                position: iwPositioncontent[i].position,
                content: iwPositioncontent[i].content
                
            });
        infowindow.open(map);
        var i=6;
        if((total-15)%250<40){i=7;}
        var infowindow = new kakao.maps.InfoWindow({
                position: iwPositioncontent[i].position,
                content: iwPositioncontent[i].content
                
            });
        infowindow.open(map);

    }
    setInterval(clock,1000);
        // 마커 위에 인포윈도우를 표시합니다. 두번째 파라미터인 marker를 넣어주지 않으면 지도 위에 표시됩니다
    
        
    </script>
</body>

</html>
